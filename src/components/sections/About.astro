---
import { getPageContent } from '../../lib/wp';
import Map from '../vue/Map.vue';

const pageContent = await getPageContent('noi-text-description');

const { content } = pageContent;
const textContent = content.replace(/<figure[\s\S]*?<\/figure>/, '').trim();

const imgMatch = content.match(/<img[^>]+src="([^"]+)"[^>]*>/);
const imgSrc = imgMatch ? imgMatch[1] : null;
---

<section
  id="noi"
  class="about-container z-10 h-[200vh] flex flex-col justify-start items-center gap-10 w-full bg-botticelli pt-36 px-20 text-white -mt-10"
>
  <div
    class="sticky top-5 max-w-[1000px] min-h-[95vh] flex justify-center items-center bg-red-400/80"
  >
    <div class="flex gap-10 w-full bg-blue-400/80">
      <div>
        <h1
          class="font-title text-3xl underline underline-offset-2 decoration-bright-peach"
        >
          Noi
        </h1>
        <div
          set:html={textContent}
          class="slide-element-in-viewport sm:w-1/2"
        />
      </div>
      <img
        src={imgSrc}
        alt="noi"
        class="w-full max-w-[300px] border-4 border-white"
      />
    </div>
    <div id="mapa" class="absolute gap-10 w-full opacity-0 hidden">
      <Map client:only />
    </div>
  </div>
</section>
<style>
  section.about-container {
    background: linear-gradient(
      to bottom,
      rgba(78, 129, 151, 0) 0%,
      rgba(78, 129, 151, 1) 10%
    );
  }
  @media (width <= 640px) {
    section.about-container {
      background: linear-gradient(
        to bottom,
        rgba(78, 129, 151, 0) 0%,
        rgba(78, 129, 151, 1) 2%
      );
    }
  }
</style>
